# Индикатор оценки качества вина

### Цель исследования
Предсказать оценку качества вина на основе данных о его физико-химических свойствах.

### Описание исследования
Цель этого проекта - предсказать качество вина по шкале от 0 до 10 с учетом набора физико-химических характеристик, оцененных сомелье.
Датасет этого проекта включает в себя информацию о красном и белом вине Vinho verde из Португалии. Каждая строка в наборе данных является красным или белым вином. Столбцы же являются атрибутами, описывающими 
его физико-химические свойства такие как:  
- Фиксированная кислотность
- Летучая кислотность
- Лимонная кислота
- Остаточный сахар
- Хлориды
- Свободный диоксид серы
- Общий диоксид серы
- Плотность
- рН
- Сульфаты

Взглянув на распределение наших 11 независимых переменных, было установлено, что все атрибуты имеют выбросы с экстремальными значениями - выбросами. В дальнейшем пришлось не только удалять выбросы, но и масштабировать числовые характеристики, чтобы уменьшить асимметрию в процессе построения модели. Кроме того, существуют проблемы с классовым дисбалансом, как видно из графиков распределения.
![Изображение](https://github.com/MelnikDM/Netology/blob/36a75bfba9ec488cfbddd8967bbebb2d52f6cb6e/CRISP_DM/WIne_Quality/reports/histplot.png)

Также был проведен корреляционный анализ, который выявил высокую положительную корелляция между free sulfur dioxide и total sulfur dioxide. Высокая обратная корелляция наблюдается между плотностью и алкоголем. Также заметная корреляция между остаточными сахарами и плотностью. Целевая переменная - качество - имеет умеренную положительную взаимосвязь с алкоголем.
![Изображение](https://github.com/MelnikDM/Netology/blob/36a75bfba9ec488cfbddd8967bbebb2d52f6cb6e/CRISP_DM/WIne_Quality/reports/heatmap.png)
Проверка статистической значимости результов корреляционного анализа показала, что результаты значимы.

### Подготовка данных
В ходе исследования была проведена предобработка данных:
  - Удалены пропуски (0,04% от всего датасета)
  - Через 3 стандартных отклонения были удалены выбросы 
  - Добавлен новый признак - quality_rate - для удобства классификации данных
  - Проведено скалирование независимых переменных

### Результаты моделирования
После того, как мы решили подойти к нашей проблеме как к проблеме классификации, мы выбрали распространенные модели машинного обучения - LogisticRegression и RandomForestClassifier. Построив пайплайн для каждой из моделей мы получили следующие результаты.

|Модель|Accuracy|Precision|Recall|f1_score|
| ------ | ------ | ------ | ------ | ------ |
|RandomForestClassifier|0.84|0.87|0.89|0.88|
|LogisticRegression|0.75|0.79|0.85|0.82|

Наилучшие результаты показал RandomForest.
